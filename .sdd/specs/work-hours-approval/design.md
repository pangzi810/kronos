# æŠ€è¡“è¨­è¨ˆæ›¸

## æ¦‚è¦
æœ¬è¨­è¨ˆæ›¸ã¯ã€é–‹ç™ºå·¥æ•°ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã«æ‰¿èªæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã®æŠ€è¡“å®Ÿè£…æ–¹é‡ã‚’å®šç¾©ã—ã¾ã™ã€‚é–‹ç™ºè€…ãŒå…¥åŠ›ã—ãŸå·¥æ•°ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€ä¸Šé•·ã«ã‚ˆã‚‹æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè£…ã—ã€å·¥æ•°ãƒ‡ãƒ¼ã‚¿ã®æ­£ç¢ºæ€§ã¨ä¿¡é ¼æ€§ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚

## è¦ä»¶ãƒãƒƒãƒ”ãƒ³ã‚°

### è¨­è¨ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£
å„è¨­è¨ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå¯¾å¿œã™ã‚‹è¦ä»¶ï¼š

- **æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³** â†’ REQ-1: æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç®¡ç†
- **ä¸Šé•·ç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«** â†’ REQ-2: æ‰¿èªè€…ç®¡ç†
- **æ‰¿èªUI/APIãƒ¬ã‚¤ãƒ¤ãƒ¼** â†’ REQ-3: æ‰¿èªç”»é¢ã¨æ“ä½œ
- **æ‰¿èªå±¥æ­´ç®¡ç†** â†’ REQ-4: æ‰¿èªæ¸ˆã¿å·¥æ•°ã®ç®¡ç†
- **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰/å¯è¦–åŒ–** â†’ REQ-5: æ‰¿èªçŠ¶æ³ã®å¯è¦–åŒ–
- **ç›£æŸ»ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ ** â†’ REQ-6: ç›£æŸ»ã¨ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹
- **UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** â†’ REQ-7: ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã¨ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚«ãƒãƒ¬ãƒƒã‚¸
- **é–‹ç™ºè€…ã‚¹ãƒˆãƒ¼ãƒªãƒ¼**: å·¥æ•°å…¥åŠ›å¾Œã®æ‰¿èªå¾…ã¡çŠ¶æ…‹ç®¡ç†ã€æ‰¿èªçŠ¶æ³ã®ç¢ºèª
- **ä¸Šé•·ã‚¹ãƒˆãƒ¼ãƒªãƒ¼**: éƒ¨ä¸‹ã®å·¥æ•°æ‰¿èª/å´ä¸‹ã€ä¸€æ‹¬æ‰¿èªæ©Ÿèƒ½
- **ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ã‚¹ãƒˆãƒ¼ãƒªãƒ¼**: ä¸Šé•·è¨­å®šç®¡ç†ã€æ‰¿èªè€…æœªè¨­å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç®¡ç†

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“æ§‹æˆ

```mermaid
graph TB
    subgraph "Presentation Layer"
        A[ä½œæ¥­ãƒ­ã‚°æ‰¿èªç”»é¢]
        B[ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰]
        C[ç®¡ç†ç”»é¢]
    end
    
    subgraph "API Layer"
        D[<b>&lt;&lt;Controller&gt;&gt;</b><br/>ApprovalController]
        E[<b>&lt;&lt;Controller&gt;&gt;</b><br/>SupervisorController]
    end
    
    subgraph "Application Layer"
        F[<b>&lt;&lt;Application Service&gt;&gt;</b><br/>ApprovalApplicationService<br/>ãƒ»æ‰¿èª/å´ä¸‹å‡¦ç†<br/>ãƒ»æ‰¿èªå¾…ã¡ä¸€è¦§å–å¾—<br/>ãƒ»ä¸€æ‹¬æ‰¿èªå‡¦ç†]
        G[<b>&lt;&lt;Application Service&gt;&gt;</b><br/>SupervisorApplicationService<br/>ãƒ»ä¸Šé•·é–¢ä¿‚ã®è¨­å®š<br/>ãƒ»éƒ¨ä¸‹ä¸€è¦§ã®å–å¾—<br/>ãƒ»ä¸Šé•·æœªè¨­å®šè€…ã®ç®¡ç†]
    end
    
    subgraph "Domain Layer"
        H[<b>&lt;&lt;Domain Service&gt;&gt;</b><br/>ApprovalWorkflowService<br/>ãƒ»æ‰¿èªå‡¦ç†å®Ÿè¡Œ<br/>ãƒ»å´ä¸‹å‡¦ç†å®Ÿè¡Œ<br/>ãƒ»ä¸€æ‹¬æ‰¿èªå‡¦ç†<br/>ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ]
        T[<b>&lt;&lt;Domain Service&gt;&gt;</b><br/>ApprovalAuthorityService<br/>ãƒ»æ‰¿èªæ¨©é™æ¤œè¨¼<br/>ãƒ»ä¸Šé•·é–¢ä¿‚ç¢ºèª<br/>ãƒ»è‡ªå·±æ‰¿èªé˜²æ­¢]
    end
    
    subgraph "Infrastructure Layer"
        L[<b>&lt;&lt;Repository Impl&gt;&gt;</b><br/>WorkRecordRepositoryImpl]
        M[<b>&lt;&lt;Repository Impl&gt;&gt;</b><br/>ApprovalHistoryRepositoryImpl]
        N[<b>&lt;&lt;Repository Impl&gt;&gt;</b><br/>SupervisorRelationshipRepositoryImpl]
        O[<b>&lt;&lt;Mapper&gt;&gt;</b><br/>MyBatis Mappers]
        P1[<b>&lt;&lt;Service&gt;&gt;</b><br/>DomainEventPublisherService<br/>ãƒ»Kafkaã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ]
    end
    
    subgraph "Database"
        P[work_records table]
        Q[approval_histories table]
        R[supervisor_relationships table]
        S[users table]
    end
    
    subgraph "Message Broker"
        K1[<b>Kafka Topic</b><br/>work-record-changed<br/>ãƒ»ä½œæˆãƒ»æ›´æ–°ãƒ»æ‰¿èªãƒ»å´ä¸‹çµ±åˆ]
    end
    
    subgraph "Event Consumer"
        A1[<b>&lt;&lt;Service&gt;&gt;</b><br/>AuditService<br/>ãƒ»ç›£æŸ»ãƒ­ã‚°ä½œæˆ<br/>ãƒ»Kafkaã‚¤ãƒ™ãƒ³ãƒˆæ¶ˆè²»]
    end
    
    A --> D
    B --> D
    C --> E
    D --> F
    E --> G
    F --> H
    F --> M
    G --> N
    H --> T
    H --> L
    H --> P1
    T --> N
    L --> O
    M --> O
    N --> O
    P1 --> K1
    O --> P
    O --> Q
    O --> R
    O --> S
    K1 --> A1
    A1 --> Q
    
    style T fill:#ffe6e6
    style H fill:#e6f3ff
```

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **Backend**: Spring Boot 3.5.4 + Java 17ï¼ˆæ—¢å­˜ï¼‰
- **Database**: MySQL 8.0ï¼ˆæ—¢å­˜ï¼‰
- **Data Access**: MyBatis 3.0.5ï¼ˆæ—¢å­˜ï¼‰
- **Security**: Spring Security + JWTï¼ˆæ—¢å­˜ï¼‰
- **Migration**: Flywayï¼ˆæ—¢å­˜ï¼‰
- **Testing**: JUnit 5 + Mockitoï¼ˆæ—¢å­˜ï¼‰
- **Message Broker**: Apache Kafka (ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œãƒ»æ¶ˆè²»)
  - ãƒˆãƒ”ãƒƒã‚¯: `work-record-changed` (ä½œæˆãƒ»æ›´æ–°ãƒ»æ‰¿èªãƒ»å´ä¸‹çµ±åˆ)

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ±ºå®šæ ¹æ‹ 

- **ãªãœã‚¹ãƒ†ãƒ¼ãƒˆãƒã‚·ãƒ³ã‚’ä½¿ã‚ãªã„ã‹**: æ‰¿èªãƒ•ãƒ­ãƒ¼ãŒã‚·ãƒ³ãƒ—ãƒ«ï¼ˆPENDING â†’ APPROVED/REJECTEDï¼‰ãªãŸã‚ã€Enumãƒ™ãƒ¼ã‚¹ã®çŠ¶æ…‹ç®¡ç†ã§ååˆ†
- **ãªãœæ‰¿èªå±¥æ­´ã‚’åˆ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã™ã‚‹ã‹**: ç›£æŸ»è¦ä»¶ã‚’æº€ãŸã™ãŸã‚ã€æ”¹ã–ã‚“é˜²æ­¢ã¨æ°¸ç¶šçš„ãªè¨˜éŒ²ä¿æŒãŒå¿…è¦
- **ãªãœä¸Šé•·é–¢ä¿‚ã‚’åˆ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã™ã‚‹ã‹**: å±¥æ­´ç®¡ç†ã¨æŸ”è»Ÿãªé–¢ä¿‚å¤‰æ›´ã‚’å¯èƒ½ã«ã—ã€è¤‡æ•°ã®ä¸Šé•·è¨­å®šï¼ˆå°†æ¥æ‹¡å¼µï¼‰ã«ã‚‚å¯¾å¿œå¯èƒ½
- **ãªãœæ¥½è¦³çš„ãƒ­ãƒƒã‚¯ã‚’ä½¿ã†ã‹**: åŒæ™‚æ‰¿èªæ“ä½œã®ç«¶åˆã‚’é˜²ãã¤ã¤ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ç¶­æŒ

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### ä¸»è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼

#### 1. å·¥æ•°å…¥åŠ›ã¨æ‰¿èªç”³è«‹ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant é–‹ç™ºè€…
    participant Frontend
    participant WorkRecordController
    participant WorkRecordApplicationService
    participant DomainEventPublisher
    participant Kafka
    participant AuditService
    participant DB
    
    é–‹ç™ºè€…->>Frontend: å·¥æ•°å…¥åŠ›
    Frontend->>WorkRecordController: PUT /api/work-records
    WorkRecordController->>WorkRecordApplicationService: saveWorkRecords() (æ—¢å­˜APIæ”¹ä¿®)
    
    Note over WorkRecordApplicationService: æ–°è¦ä½œæˆã¾ãŸã¯æ›´æ–°åˆ¤å®š
    WorkRecordApplicationService->>DB: INSERT/UPDATE work_record (status=PENDING)
    
    Note over WorkRecordApplicationService: ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
    WorkRecordApplicationService->>DomainEventPublisher: publishWorkRecordChangedEvent()
    DomainEventPublisher->>Kafka: send to "work-record-changed" topic
    
    WorkRecordApplicationService-->>WorkRecordController: List<WorkRecord> created/updated
    WorkRecordController-->>Frontend: 200 OK
    Frontend-->>é–‹ç™ºè€…: æ‰¿èªå¾…ã¡è¡¨ç¤º
    
    Note over Kafka,AuditService: éåŒæœŸã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
    Kafka->>AuditService: consume WorkRecordChangedEvent (CREATE/UPDATE)
    AuditService->>DB: INSERT approval_history
```

#### 2. ä¸Šé•·ã«ã‚ˆã‚‹æ‰¿èªãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant ä¸Šé•·
    participant Frontend
    participant ApprovalController
    participant ApprovalApplicationService
    participant ApprovalWorkflowService
    participant DomainEventPublisher
    participant Kafka
    participant AuditService
    participant DB
    
    ä¸Šé•·->>Frontend: æ‰¿èªç”»é¢ã‚¢ã‚¯ã‚»ã‚¹
    Frontend->>ApprovalController: GET /api/approvals/pending
    ApprovalController->>DB: SELECT pending work_records
    ApprovalController-->>Frontend: æ‰¿èªå¾…ã¡ãƒªã‚¹ãƒˆ
    
    ä¸Šé•·->>Frontend: æ‰¿èªå®Ÿè¡Œ
    Frontend->>ApprovalController: PUT /api/approvals/{id}/approve
    ApprovalController->>ApprovalApplicationService: approveWorkRecord()
    
    Note over ApprovalApplicationService: æ‰¿èªæ¨©é™æ¤œè¨¼
    ApprovalApplicationService->>ApprovalWorkflowService: processApproval()
    ApprovalWorkflowService->>DB: UPDATE work_record (status=APPROVED)
    
    Note over ApprovalWorkflowService: ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆ
    ApprovalWorkflowService->>ApprovalWorkflowService: create WorkRecordChangedEvent (APPROVE/REJECT)
    ApprovalWorkflowService->>DomainEventPublisher: publishWorkRecordChangedEvent()
    
    Note over DomainEventPublisher,Kafka: Kafkaã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
    DomainEventPublisher->>Kafka: send to "work-record-changed" topic
    
    ApprovalWorkflowService-->>ApprovalApplicationService: Success
    ApprovalApplicationService-->>ApprovalController: Success  
    ApprovalController-->>Frontend: 200 OK
    Frontend-->>ä¸Šé•·: æ‰¿èªå®Œäº†
    
    Note over Kafka,AuditService: éåŒæœŸã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
    Kafka->>AuditService: consume WorkRecordChangedEvent (APPROVE/REJECT)
    AuditService->>DB: INSERT approval_history
```

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ¡ã‚½ãƒƒãƒ‰ã‚·ã‚°ãƒãƒãƒ£

#### Domain Layer

```java
// Domain Event - å·¥æ•°è¨˜éŒ²å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆä½œæˆãƒ»æ›´æ–°ãƒ»æ‰¿èªçµ±åˆï¼‰
public record WorkRecordChangedEvent(
    String eventId, // workRecordId#versionå½¢å¼ï¼ˆä¾‹: "wr-123#1", "wr-123#2"ï¼‰
    String workRecordId,
    String userId,
    String projectId,
    LocalDate workDate,
    String action, // CREATE, UPDATE, APPROVE, REJECT
    ApprovalStatus previousStatus, // æ–°è¦ä½œæˆæ™‚ã¯null
    ApprovalStatus currentStatus,
    String approverId, // æ‰¿èªãƒ»å´ä¸‹æ™‚ã®ã¿è¨­å®š
    String rejectionReason, // å´ä¸‹æ™‚ã®ã¿è¨­å®š
    LocalDateTime occurredAt
) {
    // æ–°è¦ä½œæˆç”¨ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¡ã‚½ãƒƒãƒ‰
    public static WorkRecordChangedEvent forCreation(
            String workRecordId, String userId, String projectId, 
            LocalDate workDate, ApprovalStatus currentStatus, int version) {
        return new WorkRecordChangedEvent(
            workRecordId + "#" + version,
            workRecordId,
            userId,
            projectId,
            workDate,
            "CREATE",
            null,
            currentStatus,
            null,
            null,
            LocalDateTime.now()
        );
    }
    
    // æ›´æ–°ç”¨ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¡ã‚½ãƒƒãƒ‰
    public static WorkRecordChangedEvent forUpdate(
            String workRecordId, String userId, String projectId, 
            LocalDate workDate, ApprovalStatus previousStatus, 
            ApprovalStatus currentStatus, int version) {
        return new WorkRecordChangedEvent(
            workRecordId + "#" + version,
            workRecordId,
            userId,
            projectId,
            workDate,
            "UPDATE",
            previousStatus,
            currentStatus,
            null,
            null,
            LocalDateTime.now()
        );
    }
    
    // æ‰¿èªãƒ»å´ä¸‹ç”¨ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¡ã‚½ãƒƒãƒ‰
    public static WorkRecordChangedEvent forApprovalAction(
            String workRecordId, String userId, String projectId, 
            LocalDate workDate, ApprovalStatus previousStatus, 
            ApprovalStatus currentStatus, String approverId, 
            String rejectionReason, int version) {
        return new WorkRecordChangedEvent(
            workRecordId + "#" + version,
            workRecordId,
            userId,
            projectId,
            workDate,
            currentStatus == ApprovalStatus.APPROVED ? "APPROVE" : "REJECT",
            previousStatus,
            currentStatus,
            approverId,
            rejectionReason,
            LocalDateTime.now()
        );
    }
    
    public boolean isCreation() {
        return "CREATE".equals(action);
    }
    
    public boolean isUpdate() {
        return "UPDATE".equals(action);
    }
    
    public boolean isApproval() {
        return "APPROVE".equals(action);
    }
    
    public boolean isRejection() {
        return "REJECT".equals(action);
    }
    
    public boolean isStatusChange() {
        return isApproval() || isRejection();
    }
}

// Domain Entity - WorkRecord (æ—¢å­˜ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£æ‹¡å¼µ)
public class WorkRecord {
    // æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰...
    private ApprovalStatus approvalStatus = ApprovalStatus.PENDING;
    private int version = 0; // æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ç”¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·
    
    public static WorkRecord create(String userId, String projectId, LocalDate workDate, 
                                   CategoryHours categoryHours, String description, String createdBy) {
        // æ—¢å­˜ã®ä½œæˆå‡¦ç†...
        WorkRecord workRecord = new WorkRecord(userId, projectId, workDate, categoryHours, description, createdBy);
        workRecord.approvalStatus = ApprovalStatus.PENDING;
        workRecord.version = 1; // æ–°è¦ä½œæˆæ™‚ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³1
        return workRecord;
    }
    
    public void updateWorkRecord(CategoryHours categoryHours, String description) {
        // æ—¢å­˜ã®æ›´æ–°å‡¦ç†...
        
        // æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
        this.approvalStatus = ApprovalStatus.PENDING;
        this.version++; // æ›´æ–°æ™‚ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
    }
    
    public void approve(String approverId) {
        if (this.approvalStatus != ApprovalStatus.PENDING) {
            throw new IllegalStateException("Work record is not in pending status");
        }
        this.approvalStatus = ApprovalStatus.APPROVED;
        this.version++; // æ‰¿èªæ™‚ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
    }
    
    public void reject(String approverId, String reason) {
        if (this.approvalStatus != ApprovalStatus.PENDING) {
            throw new IllegalStateException("Work record is not in pending status");
        }
        this.approvalStatus = ApprovalStatus.REJECTED;
        this.version++; // å´ä¸‹æ™‚ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
    }
    
    public ApprovalStatus getApprovalStatus() {
        return this.approvalStatus;
    }
    
    public int getVersion() {
        return this.version;
    }
}

// Domain Entity
public class WorkRecordApproval {
    private String workRecordId;
    private ApprovalStatus status;  // Value Object
    private String supervisorId;
    private String rejectionReason;
    private LocalDateTime approvedAt;
    
    public void approve(String approverId) // æ‰¿èªå®Ÿè¡Œ
    public void reject(String approverId, String reason) // å´ä¸‹å®Ÿè¡Œ
    public boolean canBeEditedBy(String userId) // ç·¨é›†å¯èƒ½åˆ¤å®š
}

// Domain Entity - æ‰¿èªå±¥æ­´
public class ApprovalHistory {
    private final String id; // ã‚¤ãƒ™ãƒ³ãƒˆIDï¼ˆworkRecordId#versionå½¢å¼ã€ä¾‹: "wr-123#1", "wr-123#2"ï¼‰
    private final String workRecordId;
    private final String approverId;
    private final String action; // CREATE, UPDATE, APPROVE, REJECT
    private final ApprovalStatus previousStatus;
    private final ApprovalStatus newStatus;
    private final String rejectionReason;
    private final String workRecordSnapshot; // WorkRecordChangedEventã®JSONå½¢å¼ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
    private final LocalDateTime createdAt;
    
    public ApprovalHistory(String id, String workRecordId, String approverId,
                          String action, ApprovalStatus previousStatus, 
                          ApprovalStatus newStatus, String rejectionReason,
                          String workRecordSnapshot, LocalDateTime createdAt) {
        this.id = id;
        this.workRecordId = workRecordId;
        this.approverId = approverId;
        this.action = action;
        this.previousStatus = previousStatus;
        this.newStatus = newStatus;
        this.rejectionReason = rejectionReason;
        this.workRecordSnapshot = workRecordSnapshot;
        this.createdAt = createdAt;
    }
    
    // Getters...
}

// Domain Entity - ä¸Šé•·é–¢ä¿‚
public class SupervisorRelationship {
    private String id;
    private String userId;
    private String supervisorId;
    private LocalDate effectiveDate;
    private LocalDate endDate;
    private Boolean isActive;
    
    // ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
    public boolean isEffectiveOn(LocalDate date) {
        // æŒ‡å®šæ—¥ã«æœ‰åŠ¹ãªä¸Šé•·é–¢ä¿‚ã‹ã‚’åˆ¤å®š
        if (!isActive) return false;
        if (date.isBefore(effectiveDate)) return false;
        if (endDate != null && date.isAfter(endDate)) return false;
        return true;
    }
    
    public void terminate(LocalDate endDate) {
        // ä¸Šé•·é–¢ä¿‚ã‚’çµ‚äº†
        if (this.endDate != null) {
            throw new IllegalStateException("Relationship already terminated");
        }
        if (endDate.isBefore(effectiveDate)) {
            throw new IllegalArgumentException("End date cannot be before effective date");
        }
        this.endDate = endDate;
        this.isActive = false;
    }
    
    public void changeSupervisor(String newSupervisorId, LocalDate changeDate) {
        // ä¸Šé•·ã‚’å¤‰æ›´ï¼ˆç¾åœ¨ã®é–¢ä¿‚ã‚’çµ‚äº†ã—ã€æ–°ã—ã„é–¢ä¿‚ã®é–‹å§‹ã‚’ç¤ºå”†ï¼‰
        if (newSupervisorId.equals(this.supervisorId)) {
            throw new IllegalArgumentException("New supervisor is same as current");
        }
        this.terminate(changeDate.minusDays(1));
    }
    
    public boolean canApprove(String approverId) {
        // æŒ‡å®šã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰¿èªæ¨©é™ã‚’æŒã¤ã‹åˆ¤å®š
        return this.supervisorId.equals(approverId) && this.isActive;
    }
    
    public boolean isSelfSupervision() {
        // è‡ªå·±ç›£ç£ï¼ˆè‡ªåˆ†ãŒè‡ªåˆ†ã®ä¸Šé•·ï¼‰ã‹ã‚’åˆ¤å®š
        return this.userId.equals(this.supervisorId);
    }
}

// Value Object
public enum ApprovalStatus {
    PENDING,    // æ‰¿èªå¾…ã¡
    APPROVED,   // æ‰¿èªæ¸ˆã¿
    REJECTED    // å´ä¸‹
}

// Domain Service - æ‰¿èªæ¨©é™æ¤œè¨¼
@Service
@RequiredArgsConstructor
public class ApprovalAuthorityService {
    private final SupervisorRelationshipRepository supervisorRelationshipRepository;
    
    public void validateApprovalAuthority(String workRecordUserId, String approverId) {
        // 1. è‡ªå·±æ‰¿èªã®é˜²æ­¢
        if (workRecordUserId.equals(approverId)) {
            throw new SelfApprovalException("Self-approval is not allowed");
        }
        
        // 2. ä¸Šé•·é–¢ä¿‚ã®ç¢ºèª
        SupervisorRelationship relationship = supervisorRelationshipRepository
            .findActiveByUserId(workRecordUserId)
            .orElseThrow(() -> new SupervisorNotSetException("Supervisor not set for user: " + workRecordUserId));
        
        // 3. æ‰¿èªæ¨©é™ã®æ¤œè¨¼
        if (!relationship.getSupervisorId().equals(approverId)) {
            throw new UnauthorizedApprovalException(
                "User " + approverId + " is not authorized to approve work records of user " + workRecordUserId
            );
        }
    }
    
    public List<String> getSubordinateIds(String supervisorId) {
        return supervisorRelationshipRepository.findSubordinateIdsBySupervisorId(supervisorId);
    }
    
    public Optional<String> getActiveSupervisorId(String userId) {
        return supervisorRelationshipRepository
            .findActiveByUserId(userId)
            .map(SupervisorRelationship::getSupervisorId);
    }
}

// Domain Service - æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
@Service
@RequiredArgsConstructor
public class ApprovalWorkflowService {
    private final WorkRecordRepository workRecordRepository;
    private final ApprovalAuthorityService approvalAuthorityService;
    private final DomainEventPublisherService domainEventPublisher;
    
    public void processApproval(String workRecordId, String approverId) {
        // 1. å·¥æ•°è¨˜éŒ²ã‚’å–å¾—
        WorkRecord workRecord = workRecordRepository.findById(workRecordId)
            .orElseThrow(() -> new NotFoundException("WorkRecord not found"));
        
        // 2. æ‰¿èªæ¨©é™ã®æ¤œè¨¼ï¼ˆApprovalAuthorityServiceã«å§”è­²ï¼‰
        approvalAuthorityService.validateApprovalAuthority(
            workRecord.getUserId(), 
            approverId
        );
        
        // 3. æ‰¿èªå‡¦ç†å®Ÿè¡Œï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯å†…éƒ¨ã§ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã•ã‚Œã‚‹ï¼‰
        ApprovalStatus previousStatus = workRecord.getApprovalStatus();
        workRecord.approve(approverId);
        workRecordRepository.save(workRecord);
        
        // 4. ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œï¼ˆworkRecordã‹ã‚‰ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ï¼‰
        WorkRecordChangedEvent event = WorkRecordChangedEvent.forApprovalAction(
            workRecord.getId(),
            workRecord.getUserId(),
            workRecord.getProjectId(),
            workRecord.getWorkDate(),
            previousStatus,
            workRecord.getApprovalStatus(), // æ‰¿èªå¾Œã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’workRecordã‹ã‚‰å–å¾—
            approverId,
            null, // æ‰¿èªæ™‚ã¯å´ä¸‹ç†ç”±ãªã—
            workRecord.getVersion() // workRecordã‹ã‚‰ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—
        );
        domainEventPublisher.publishWorkRecordChangedEvent(event);
    }
    
    public void processRejection(String workRecordId, String approverId, String reason) {
        // 1. å·¥æ•°è¨˜éŒ²ã‚’å–å¾—
        WorkRecord workRecord = workRecordRepository.findById(workRecordId)
            .orElseThrow(() -> new NotFoundException("WorkRecord not found"));
        
        // 2. æ‰¿èªæ¨©é™ã®æ¤œè¨¼ï¼ˆApprovalAuthorityServiceã«å§”è­²ï¼‰
        approvalAuthorityService.validateApprovalAuthority(
            workRecord.getUserId(), 
            approverId
        );
        
        // 3. å´ä¸‹ç†ç”±ã®æ¤œè¨¼
        if (reason == null || reason.trim().isEmpty()) {
            throw new ValidationException("Rejection reason is required");
        }
        
        // 4. å´ä¸‹å‡¦ç†å®Ÿè¡Œï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯å†…éƒ¨ã§ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã•ã‚Œã‚‹ï¼‰
        ApprovalStatus previousStatus = workRecord.getApprovalStatus();
        workRecord.reject(approverId, reason);
        workRecordRepository.save(workRecord);
        
        // 5. ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œï¼ˆworkRecordã‹ã‚‰ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ï¼‰
        WorkRecordChangedEvent event = WorkRecordChangedEvent.forApprovalAction(
            workRecord.getId(),
            workRecord.getUserId(),
            workRecord.getProjectId(),
            workRecord.getWorkDate(),
            previousStatus,
            workRecord.getApprovalStatus(), // å´ä¸‹å¾Œã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’workRecordã‹ã‚‰å–å¾—
            approverId,
            reason,
            workRecord.getVersion() // workRecordã‹ã‚‰ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—
        );
        domainEventPublisher.publishWorkRecordChangedEvent(event);
    }
    
    public void processBulkApproval(List<String> workRecordIds, String approverId) {
        for (String workRecordId : workRecordIds) {
            // å„å·¥æ•°è¨˜éŒ²ã«å¯¾ã—ã¦æ‰¿èªå‡¦ç†ã‚’å®Ÿè¡Œ
            // æ‰¿èªæ¨©é™æ¤œè¨¼ã‚‚å€‹åˆ¥ã«å®Ÿè¡Œã•ã‚Œã‚‹
            processApproval(workRecordId, approverId);
        }
    }
}

// Repository Interface
public interface ApprovalRepository {
    List<WorkRecord> findPendingBySupervisorId(String supervisorId);
    void updateApprovalStatus(Long workRecordId, ApprovalStatus status);
}

public interface SupervisorRelationshipRepository {
    Optional<SupervisorRelationship> findActiveByUserId(String userId);
    List<String> findSubordinateIdsBySupervisorId(String supervisorId);
    void save(SupervisorRelationship relationship);
}

public interface ApprovalHistoryRepository {
    void save(ApprovalHistory history);
    List<ApprovalHistory> findByWorkRecordId(String workRecordId);
    Optional<ApprovalHistory> findById(String id);
}
```

#### Application Layer

```java
// Infrastructure Service - ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œã‚µãƒ¼ãƒ“ã‚¹
@Component
@RequiredArgsConstructor
public class DomainEventPublisherService {
    private final KafkaTemplate<String, Object> kafkaTemplate;
    
    private static final String WORK_RECORD_CHANGED_TOPIC = "work-record-changed";
    
    public void publishWorkRecordChangedEvent(WorkRecordChangedEvent event) {
        // userIdã‚’ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã¨ã—ã¦ä½¿ç”¨ï¼ˆåŒä¸€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒé †åºä¿è¨¼ã•ã‚Œã‚‹ï¼‰
        kafkaTemplate.send(WORK_RECORD_CHANGED_TOPIC, event.userId(), event);
    }
}

// Infrastructure Service - ç›£æŸ»ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆKafkaã‚¤ãƒ™ãƒ³ãƒˆã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ï¼‰
@Component
@RequiredArgsConstructor
public class AuditService {
    private final ApprovalHistoryRepository approvalHistoryRepository;
    private final ObjectMapper objectMapper;
    
    @KafkaListener(topics = "work-record-changed")
    public void handleWorkRecordChangedEvent(WorkRecordChangedEvent event) {
        // ã‚¤ãƒ™ãƒ³ãƒˆã‹ã‚‰ç›£æŸ»å±¥æ­´ã‚’ä½œæˆ
        // CREATE/UPDATEã®å ´åˆã¯userIdã‚’ã€APPROVE/REJECTã®å ´åˆã¯approverIdã‚’è¨˜éŒ²è€…ã¨ã—ã¦ä½¿ç”¨
        String actionUserId = event.isStatusChange() ? event.approverId() : event.userId();
        
        // WorkRecordChangedEventã‚’ç›´æ¥JSONæ–‡å­—åˆ—ã«ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º
        String eventSnapshot = serializeEvent(event);
        
        ApprovalHistory history = new ApprovalHistory(
            event.eventId(), // ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ãã®ã¾ã¾å±¥æ­´IDã¨ã—ã¦ä½¿ç”¨
            event.workRecordId(),
            actionUserId,
            event.action(),
            event.previousStatus(),
            event.currentStatus(),
            event.rejectionReason(),
            eventSnapshot, // ã‚¤ãƒ™ãƒ³ãƒˆå…¨ä½“ã‚’JSONæ–‡å­—åˆ—ã¨ã—ã¦ä¿å­˜
            event.occurredAt()
        );
        
        approvalHistoryRepository.save(history);
    }
    
    private String serializeEvent(WorkRecordChangedEvent event) {
        try {
            // WorkRecordChangedEventã‚’ç›´æ¥JSONæ–‡å­—åˆ—ã«ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º
            return objectMapper.writeValueAsString(event);
        } catch (JsonProcessingException e) {
            throw new RuntimeException("Failed to serialize WorkRecordChangedEvent", e);
        }
    }
}

@Service
@RequiredArgsConstructor
public class ApprovalApplicationService {
    private final WorkRecordRepository workRecordRepository;
    private final ApprovalWorkflowService approvalWorkflowService;
    private final ApprovalAuthorityService approvalAuthorityService;
    
    public ApprovalSummaryDto getApprovalSummary(String userId) {
        // æ‰¿èªã‚µãƒãƒªãƒ¼å–å¾—
        // è‡ªåˆ†ã®æ‰¿èªå¾…ã¡/æ‰¿èªæ¸ˆã¿/å´ä¸‹ä»¶æ•°ã‚’å–å¾—
    }
    
    public PendingApprovalsDto getPendingApprovals(String supervisorId) {
        // æ‰¿èªå¾…ã¡ä¸€è¦§å–å¾—
        List<String> subordinateIds = approvalAuthorityService.getSubordinateIds(supervisorId);
        return workRecordRepository.findPendingByUserIds(subordinateIds);
    }
    
    @Transactional
    public void approveWorkRecord(String workRecordId, String approverId) {
        // ApprovalWorkflowServiceã«æ‰¿èªå‡¦ç†ã‚’å§”è­²
        // æ‰¿èªæ¨©é™æ¤œè¨¼ã‚‚ApprovalWorkflowServiceå†…ã§å®Ÿè¡Œã•ã‚Œã‚‹
        approvalWorkflowService.processApproval(workRecordId, approverId);
    }
    
    @Transactional
    public void rejectWorkRecord(String workRecordId, String approverId, String reason) {
        // ApprovalWorkflowServiceã«å´ä¸‹å‡¦ç†ã‚’å§”è­²
        // æ‰¿èªæ¨©é™æ¤œè¨¼ã‚‚ApprovalWorkflowServiceå†…ã§å®Ÿè¡Œã•ã‚Œã‚‹
        approvalWorkflowService.processRejection(workRecordId, approverId, reason);
    }
    
    @Transactional
    public void bulkApprove(List<String> workRecordIds, String approverId) {
        // ApprovalWorkflowServiceã«ä¸€æ‹¬æ‰¿èªå‡¦ç†ã‚’å§”è­²
        // æ‰¿èªæ¨©é™æ¤œè¨¼ã‚‚ApprovalWorkflowServiceå†…ã§å®Ÿè¡Œã•ã‚Œã‚‹
        approvalWorkflowService.processBulkApproval(workRecordIds, approverId);
    }
}

public class SupervisorApplicationService {
    public void assignSupervisor(String userId, String supervisorId) // ä¸Šé•·è¨­å®š
    public List<UserDto> getUsersWithoutSupervisor() // ä¸Šé•·æœªè¨­å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§
    public List<UserDto> getSubordinates(String supervisorId) // éƒ¨ä¸‹ä¸€è¦§å–å¾—
}
```

### APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

| Method | Route | Purpose | Auth | Status Codes |
|--------|-------|---------|------|--------------|
| GET | /api/approvals/pending | æ‰¿èªå¾…ã¡å·¥æ•°ä¸€è¦§å–å¾— | Required (Supervisor) | 200, 401, 403, 500 |
| GET | /api/approvals/summary | æ‰¿èªã‚µãƒãƒªãƒ¼å–å¾— | Required | 200, 401, 500 |
| PUT | /api/approvals/{id}/approve | å·¥æ•°æ‰¿èª | Required (Supervisor) | 200, 400, 401, 403, 404, 500 |
| PUT | /api/approvals/{id}/reject | å·¥æ•°å´ä¸‹ | Required (Supervisor) | 200, 400, 401, 403, 404, 500 |
| POST | /api/approvals/bulk-approve | ä¸€æ‹¬æ‰¿èª | Required (Supervisor) | 200, 400, 401, 403, 500 |
| GET | /api/users/subordinates | éƒ¨ä¸‹ä¸€è¦§å–å¾— | Required (Supervisor) | 200, 401, 403, 500 |
| PUT | /api/users/{id}/supervisor | ä¸Šé•·è¨­å®š | Required (Admin) | 200, 400, 401, 403, 404, 500 |
| GET | /api/users/without-supervisor | ä¸Šé•·æœªè¨­å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ | Required (Admin) | 200, 401, 403, 500 |

## ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£

1. **WorkRecord** (æ—¢å­˜æ‹¡å¼µ): å·¥æ•°è¨˜éŒ²ã«æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿½åŠ 
2. **ApprovalHistory**: æ‰¿èªå±¥æ­´ï¼ˆæ–°è¦ï¼‰
3. **SupervisorRelationship**: ä¸Šé•·é–¢ä¿‚ï¼ˆæ–°è¦ï¼‰
4. **User** (æ—¢å­˜): å¤‰æ›´ãªã—

### ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é–¢ä¿‚å›³

```mermaid
erDiagram
    USER ||--o{ SUPERVISOR_RELATIONSHIP : "subordinate"
    USER ||--o{ SUPERVISOR_RELATIONSHIP : "supervisor"
    USER ||--o{ WORK_RECORD : "creates"
    USER ||--o{ APPROVAL_HISTORY : "approves"
    WORK_RECORD ||--o{ APPROVAL_HISTORY : "has"
    
    USER {
        varchar id PK
        string username
        string email
        timestamp created_at
        timestamp updated_at
    }
    
    SUPERVISOR_RELATIONSHIP {
        varchar id PK
        varchar user_id FK "subordinate"
        varchar supervisor_id FK "supervisor"
        date effective_date
        date end_date
        boolean is_active
        timestamp created_at
        timestamp updated_at
    }
    
    WORK_RECORD {
        varchar id PK
        varchar user_id FK
        varchar project_id FK
        date work_date
        decimal hours
        string approval_status
        string rejection_reason
        timestamp approved_at
        int version
        timestamp created_at
        timestamp updated_at
    }
    
    APPROVAL_HISTORY {
        varchar id PK "workRecordId#version"
        varchar work_record_id FK
        varchar approver_id FK
        string action
        string status
        string reason
        json work_record_snapshot
        timestamp created_at
    }
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

#### Migration V7: æ‰¿èªæ©Ÿèƒ½è¿½åŠ 

```sql
-- V7__add_approval_features.sql

-- ä¸Šé•·é–¢ä¿‚ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
CREATE TABLE supervisor_relationships (
    id VARCHAR(255) NOT NULL,
    user_id VARCHAR(255) NOT NULL,
    supervisor_id VARCHAR(255) NOT NULL,
    effective_date DATE NOT NULL DEFAULT (CURRENT_DATE),
    end_date DATE NULL,
    is_active BOOLEAN NOT NULL DEFAULT TRUE,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (id),
    CONSTRAINT fk_supervisor_relationship_user 
        FOREIGN KEY (user_id) REFERENCES users(id),
    CONSTRAINT fk_supervisor_relationship_supervisor 
        FOREIGN KEY (supervisor_id) REFERENCES users(id),
    CONSTRAINT uk_active_supervisor 
        UNIQUE KEY (user_id, is_active)
);

CREATE INDEX idx_supervisor_relationships_user ON supervisor_relationships(user_id);
CREATE INDEX idx_supervisor_relationships_supervisor ON supervisor_relationships(supervisor_id);
CREATE INDEX idx_supervisor_relationships_active ON supervisor_relationships(is_active);

-- work_recordsãƒ†ãƒ¼ãƒ–ãƒ«ã«æ‰¿èªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½åŠ 
ALTER TABLE work_records
ADD COLUMN approval_status VARCHAR(20) NOT NULL DEFAULT 'PENDING',
ADD COLUMN rejection_reason TEXT NULL,
ADD COLUMN approved_at TIMESTAMP NULL,
ADD COLUMN approved_by VARCHAR(255) NULL,
ADD COLUMN version INT NOT NULL DEFAULT 1,
ADD CONSTRAINT fk_work_record_approver 
    FOREIGN KEY (approved_by) REFERENCES users(id);

CREATE INDEX idx_work_records_approval_status ON work_records(approval_status);
CREATE INDEX idx_work_records_user_status ON work_records(user_id, approval_status);

-- æ‰¿èªå±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
CREATE TABLE approval_histories (
    id VARCHAR(255) NOT NULL, -- ã‚¤ãƒ™ãƒ³ãƒˆIDï¼ˆworkRecordId#versionï¼‰
    work_record_id VARCHAR(255) NOT NULL,
    approver_id VARCHAR(255) NOT NULL,
    action VARCHAR(20) NOT NULL, -- APPROVE, REJECT
    previous_status VARCHAR(20) NOT NULL,
    new_status VARCHAR(20) NOT NULL,
    rejection_reason TEXT NULL,
    work_record_snapshot JSON NOT NULL, -- æ‰¿èªæ™‚ç‚¹ã®å·¥æ•°æƒ…å ±ã‚³ãƒ”ãƒ¼
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (id),
    CONSTRAINT fk_approval_history_work_record 
        FOREIGN KEY (work_record_id) REFERENCES work_records(id),
    CONSTRAINT fk_approval_history_approver 
        FOREIGN KEY (approver_id) REFERENCES users(id)
);

CREATE INDEX idx_approval_histories_work_record ON approval_histories(work_record_id);
CREATE INDEX idx_approval_histories_approver ON approval_histories(approver_id);
CREATE INDEX idx_approval_histories_created ON approval_histories(created_at);
```

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥

1. **æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®æ‰±ã„**: æ—¢å­˜ã®work_recordsã¯ã™ã¹ã¦PENDINGçŠ¶æ…‹ã§åˆæœŸåŒ–
2. **å¾Œæ–¹äº’æ›æ€§**: approval_statusã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®šã—ã€æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¸ã®å½±éŸ¿ã‚’æœ€å°åŒ–
3. **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æˆ¦ç•¥**: æ‰¿èªå¾…ã¡æ¤œç´¢ã€ä¸Šé•·åˆ¥æ¤œç´¢ã‚’é«˜é€ŸåŒ–
4. **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§**: å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã«ã‚ˆã‚Šä¸Šé•·é–¢ä¿‚ã®æ•´åˆæ€§ã‚’ä¿è¨¼
5. **ä¸Šé•·é–¢ä¿‚ã®ç®¡ç†**: is_activeãƒ•ãƒ©ã‚°ã¨ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ã«ã‚ˆã‚Šã€åŒæ™‚ã«è¤‡æ•°ã®æœ‰åŠ¹ãªä¸Šé•·ã‚’æŒãŸãªã„ã“ã¨ã‚’ä¿è¨¼

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã¨å¯¾å¿œ

| ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ | HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ | å¯¾å¿œæ–¹æ³• |
|------------|--------------|------------|---------|
| ä¸Šé•·æœªè¨­å®šã§ã®æ‰¿èªè©¦è¡Œ | 400 | SUPERVISOR_NOT_SET | ä¸Šé•·è¨­å®šã‚’ä¿ƒã™ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º |
| æ¨©é™ãªã—æ‰¿èªè©¦è¡Œ | 403 | UNAUTHORIZED_APPROVAL | æ¨©é™ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| è‡ªå·±æ‰¿èªè©¦è¡Œ | 403 | SELF_APPROVAL | è‡ªå·±æ‰¿èªä¸å¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| æ‰¿èªæ¸ˆã¿å·¥æ•°ã®å†æ‰¿èª | 409 | ALREADY_APPROVED | çŠ¶æ…‹ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| å´ä¸‹ç†ç”±æœªå…¥åŠ› | 400 | REJECTION_REASON_REQUIRED | å¿…é ˆå…¥åŠ›ã‚¨ãƒ©ãƒ¼ |
| æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ç«¶åˆ | 409 | CONCURRENT_UPDATE | ãƒªãƒˆãƒ©ã‚¤ä¿ƒé€²ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |

### ä¾‹å¤–ã‚¯ãƒ©ã‚¹å®šç¾©

```java
// Domain Exceptions
public class SupervisorNotSetException extends DomainException {
    public SupervisorNotSetException(String message) {
        super(message, "SUPERVISOR_NOT_SET");
    }
}

public class UnauthorizedApprovalException extends DomainException {
    public UnauthorizedApprovalException(String message) {
        super(message, "UNAUTHORIZED_APPROVAL");
    }
}

public class SelfApprovalException extends DomainException {
    public SelfApprovalException(String message) {
        super(message, "SELF_APPROVAL");
    }
}

public class AlreadyApprovedException extends DomainException {
    public AlreadyApprovedException(String message) {
        super(message, "ALREADY_APPROVED");
    }
}
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

### èªè¨¼ã¨èªå¯

```mermaid
sequenceDiagram
    participant User
    participant API
    participant AuthFilter
    participant ApprovalService
    participant DB
    
    User->>API: PUT /api/approvals/{id}/approve
    API->>AuthFilter: Validate JWT Token
    AuthFilter->>DB: Get user roles & supervisor status
    AuthFilter-->>API: Authentication OK
    API->>ApprovalService: Check authorization
    ApprovalService->>DB: Verify supervisor relationship
    alt Is valid supervisor
        ApprovalService-->>API: Authorized
        API->>ApprovalService: Process approval
    else Not supervisor
        ApprovalService-->>API: 403 Forbidden
    end
```

### ãƒ‡ãƒ¼ã‚¿ä¿è­·

- **å…¥åŠ›æ¤œè¨¼**: å´ä¸‹ç†ç”±ã®é•·ã•åˆ¶é™ï¼ˆ1000æ–‡å­—ï¼‰ã€XSSå¯¾ç­–
- **SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–**: MyBatisã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ä½¿ç”¨
- **ç›£æŸ»ãƒ­ã‚°ã®æ”¹ã–ã‚“é˜²æ­¢**: approval_historiesãƒ†ãƒ¼ãƒ–ãƒ«ã¯INSERTã®ã¿è¨±å¯ï¼ˆUPDATE/DELETEä¸å¯ï¼‰
- **è‡ªå·±æ‰¿èªé˜²æ­¢**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã§ç”³è«‹è€…ã¨æ‰¿èªè€…ã®åŒä¸€æ€§ãƒã‚§ãƒƒã‚¯

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

- **æœ€å°æ¨©é™ã®åŸå‰‡**: æ‰¿èªæ©Ÿèƒ½ã¯ä¸Šé•·ãƒ­ãƒ¼ãƒ«ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- **APIãƒ¬ãƒ¼ãƒˆåˆ¶é™**: æ‰¿èªAPIã¯1åˆ†é–“ã«60ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ã§
- **CORSè¨­å®š**: æ‰¿èªAPIã¯ç‰¹å®šã®ã‚ªãƒªã‚¸ãƒ³ã®ã¿è¨±å¯
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼**: CSPã€X-Frame-Optionsç­‰ã®è¨­å®š

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™

| ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | ç›®æ¨™å€¤ | æ¸¬å®šå¯¾è±¡ |
|----------|--------|---------|
| æ‰¿èªå¾…ã¡ä¸€è¦§è¡¨ç¤º (p95) | < 200ms | GET /api/approvals/pending |
| å˜ä¸€æ‰¿èªå‡¦ç† (p99) | < 500ms | PUT /api/approvals/{id}/approve |
| ä¸€æ‹¬æ‰¿èªå‡¦ç† (100ä»¶) | < 10s | POST /api/approvals/bulk-approve |
| DBæ‰¿èªå¾…ã¡æ¤œç´¢ (p99) | < 50ms | supervisoråˆ¥ã‚¯ã‚¨ãƒª |

### ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

- **èª­ã¿å–ã‚Šè² è·åˆ†æ•£**: æ‰¿èªå¾…ã¡ä¸€è¦§ã¯ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ã‹ã‚‰å–å¾—
- **éåŒæœŸå‡¦ç†**: ç›£æŸ»ãƒ­ã‚°è¨˜éŒ²ã¯éåŒæœŸåŒ–
- **ãƒãƒƒãƒå‡¦ç†**: é•·æœŸæœªæ‰¿èªã‚¢ãƒ©ãƒ¼ãƒˆã¯å¤œé–“ãƒãƒƒãƒã§å‡¦ç†
- **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–**: supervisor_idã€approval_statusã«è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

## ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸è¦ä»¶

- **å˜ä½“ãƒ†ã‚¹ãƒˆ**: 90%ä»¥ä¸Šã®ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ï¼ˆJaCoCoï¼‰
- **çµ±åˆãƒ†ã‚¹ãƒˆ**: å…¨æ‰¿èªAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- **E2Eãƒ†ã‚¹ãƒˆ**: æ‰¿èªãƒ•ãƒ­ãƒ¼å…¨ä½“ï¼ˆç”³è«‹â†’æ‰¿èª/å´ä¸‹â†’å±¥æ­´ç¢ºèªï¼‰

### ãƒ†ã‚¹ãƒˆã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

#### 1. å˜ä½“ãƒ†ã‚¹ãƒˆ

```java
@Test
void testApproveWorkRecord() {
    // Given
    WorkRecord workRecord = createPendingWorkRecord();
    String supervisorId = "2";
    
    // When
    approvalService.approve(workRecord.getId(), supervisorId);
    
    // Then
    assertEquals(ApprovalStatus.APPROVED, workRecord.getApprovalStatus());
    assertNotNull(workRecord.getApprovedAt());
}

@Test
void testCannotApproveSelfWorkRecord() {
    // Given
    WorkRecord workRecord = createPendingWorkRecord(userId: "1");
    
    // When/Then
    assertThrows(SelfApprovalException.class, 
        () -> approvalService.approve(workRecord.getId(), "1"));
}
```

#### 2. çµ±åˆãƒ†ã‚¹ãƒˆ

```java
@SpringBootTest
@AutoConfigureMockMvc
class ApprovalControllerIntegrationTest {
    
    @Test
    @WithMockUser(roles = "SUPERVISOR")
    void testApprovalEndpoint() throws Exception {
        mockMvc.perform(put("/api/approvals/1/approve"))
            .andExpect(status().isOk())
            .andExpect(jsonPath("$.status").value("APPROVED"));
    }
}
```

### CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```mermaid
graph LR
    A[Git Push] --> B[Compile]
    B --> C[Unit Tests]
    C --> D[Integration Tests]
    D --> E[JaCoCo Coverage Check]
    E --> F{Coverage >= 90%?}
    F -->|Yes| G[Build Docker Image]
    F -->|No| H[Build Failed]
    G --> I[Deploy to Staging]
    I --> J[E2E Tests]
    J --> K[Performance Tests]
    K --> L[Deploy to Production]
```

## å®Ÿè£…å„ªå…ˆé †ä½

### ãƒ•ã‚§ãƒ¼ã‚º1: åŸºæœ¬æ‰¿èªæ©Ÿèƒ½ï¼ˆå¿…é ˆï¼‰
1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ï¼ˆMigration V7ï¼‰
2. ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨Value Objectå®Ÿè£…
3. æ‰¿èª/å´ä¸‹APIå®Ÿè£…
4. æ‰¿èªå±¥æ­´è¨˜éŒ²æ©Ÿèƒ½

### ãƒ•ã‚§ãƒ¼ã‚º2: ç®¡ç†æ©Ÿèƒ½
1. ä¸Šé•·è¨­å®šç®¡ç†API
2. æ‰¿èªå¾…ã¡ä¸€è¦§è¡¨ç¤º
3. ä¸€æ‹¬æ‰¿èªæ©Ÿèƒ½

### ãƒ•ã‚§ãƒ¼ã‚º3: å¯è¦–åŒ–ã¨UXå‘ä¸Š
1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çµ±è¨ˆè¡¨ç¤º
2. æ‰¿èªå¾…ã¡ä»¶æ•°ãƒãƒƒã‚¸
3. ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½

## ç”»é¢è¨­è¨ˆ

### ç”»é¢æ§‹æˆ

#### 1. ç”»é¢ä¸€è¦§ã¨å½¹å‰²

| ç”»é¢å | URL | å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ | ä¸»ãªæ©Ÿèƒ½ |
|--------|-----|------------|---------|
| å·¥æ•°å…¥åŠ›ç”»é¢ï¼ˆæ‹¡å¼µï¼‰ | /work-records | é–‹ç™ºè€… | å·¥æ•°å…¥åŠ›ã€æ‰¿èªçŠ¶æ³ç¢ºèª |
| æ‰¿èªå¾…ã¡ä¸€è¦§ç”»é¢ | /approvals/pending | ä¸Šé•· | éƒ¨ä¸‹ã®å·¥æ•°ç¢ºèªã€æ‰¿èª/å´ä¸‹ |
| æ‰¿èªå±¥æ­´ç”»é¢ | /approvals/history | é–‹ç™ºè€…/ä¸Šé•· | æ‰¿èªå±¥æ­´ã®ç¢ºèª |
| ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆæ‹¡å¼µï¼‰ | /dashboard | å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ | æ‰¿èªçŠ¶æ³ã‚µãƒãƒªãƒ¼è¡¨ç¤º |
| ä¸Šé•·è¨­å®šç”»é¢ | /admin/supervisors | ç®¡ç†è€… | ä¸Šé•·é–¢ä¿‚ã®è¨­å®šãƒ»ç®¡ç† |

#### 2. ç”»é¢é·ç§»å›³

```mermaid
graph LR
    A[ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢] --> B[ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰]
    B --> C[å·¥æ•°å…¥åŠ›ç”»é¢]
    B --> D[æ‰¿èªå¾…ã¡ä¸€è¦§ç”»é¢]
    B --> E[æ‰¿èªå±¥æ­´ç”»é¢]
    B --> F[ä¸Šé•·è¨­å®šç”»é¢]
    
    C --> G[æ‰¿èªç”³è«‹ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°]
    G --> C
    
    D --> H[æ‰¿èªè©³ç´°ç”»é¢]
    H --> I[æ‰¿èªç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°]
    H --> J[å´ä¸‹ç†ç”±å…¥åŠ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚°]
    I --> D
    J --> D
    
    E --> K[å±¥æ­´è©³ç´°ç”»é¢]
    
    F --> L[ä¸Šé•·ç·¨é›†ãƒ€ã‚¤ã‚¢ãƒ­ã‚°]
    L --> F
```

### å€‹åˆ¥ç”»é¢è¨­è¨ˆ

#### 1. å·¥æ•°å…¥åŠ›ç”»é¢ï¼ˆæ‹¡å¼µï¼‰

**ç”»é¢è¦ç´ **
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å·¥æ•°å…¥åŠ›                                    2024å¹´1æœˆ15æ—¥ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: [ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³     â–¼]                      â”‚
â”‚ ä½œæ¥­æ—¥:      [2024-01-15        ]                       â”‚
â”‚                                                          â”‚
â”‚ ã‚«ãƒ†ã‚´ãƒªåˆ¥å·¥æ•°:                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚ â”‚ è¨­è¨ˆ         â”‚ [2.5] h â”‚                              â”‚
â”‚ â”‚ å®Ÿè£…         â”‚ [4.0] h â”‚                              â”‚
â”‚ â”‚ ãƒ†ã‚¹ãƒˆ       â”‚ [1.5] h â”‚                              â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                          â”‚
â”‚ æ‰¿èªçŠ¶æ³: ğŸŸ¡ æ‰¿èªå¾…ã¡                                    â”‚
â”‚                                                          â”‚
â”‚ [ä¿å­˜]                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½ä»•æ§˜**
- æ—¢å­˜ã®å·¥æ•°å…¥åŠ›æ©Ÿèƒ½ã«æ‰¿èªçŠ¶æ³è¡¨ç¤ºã‚’è¿½åŠ 
- ä¿å­˜æ™‚ã«è‡ªå‹•çš„ã«æ‰¿èªå¾…ã¡çŠ¶æ…‹ï¼ˆPENDINGï¼‰ã¨ãªã‚‹
- æ‰¿èªçŠ¶æ³ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼:
  - ğŸŸ¢ æ‰¿èªæ¸ˆã¿ (APPROVED)
  - ğŸŸ¡ æ‰¿èªå¾…ã¡ (PENDING)
  - ğŸ”´ å´ä¸‹ (REJECTED)
- æ‰¿èªæ¸ˆã¿å·¥æ•°ã¯ç·¨é›†ä¸å¯ï¼ˆã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆè¡¨ç¤ºï¼‰
- å´ä¸‹ã•ã‚ŒãŸå ´åˆã¯å´ä¸‹ç†ç”±ã‚’ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã§è¡¨ç¤º

#### 2. æ‰¿èªå¾…ã¡ä¸€è¦§ç”»é¢

**ç”»é¢è¦ç´ **
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰¿èªå¾…ã¡å·¥æ•°ä¸€è¦§                         æœªæ‰¿èª: 12ä»¶    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ãƒ•ã‚£ãƒ«ã‚¿: [å…¨ã¦ â–¼] æœŸé–“: [2024-01] [æ¤œç´¢]               â”‚
â”‚                                                          â”‚
â”‚ â–¡ é–‹ç™ºè€…    ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ  ä½œæ¥­æ—¥      å·¥æ•°  ã‚¢ã‚¯ã‚·ãƒ§ãƒ³   â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¡ ç”°ä¸­å¤ªéƒ  Project A    2024-01-15  8.0h  [æ‰¿èª][å´ä¸‹]â”‚
â”‚ â–¡ éˆ´æœ¨èŠ±å­  Project B    2024-01-15  7.5h  [æ‰¿èª][å´ä¸‹]â”‚
â”‚ â–¡ ä½è—¤æ¬¡éƒ  Project A    2024-01-14  8.5h  [æ‰¿èª][å´ä¸‹]â”‚
â”‚                                                          â”‚
â”‚ [é¸æŠã—ãŸé …ç›®ã‚’ä¸€æ‹¬æ‰¿èª]                                 â”‚
â”‚                                                          â”‚
â”‚ ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³: < 1 2 3 4 5 > è¡¨ç¤ºä»¶æ•°: [20 â–¼]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½ä»•æ§˜**
- éƒ¨ä¸‹ã®æ‰¿èªå¾…ã¡å·¥æ•°ã‚’ä¸€è¦§è¡¨ç¤º
- ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§æ‰¿èª/å´ä¸‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
- å´ä¸‹æ™‚ã¯ç†ç”±å…¥åŠ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
- ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½:
  - é–‹ç™ºè€…åˆ¥
  - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ¥
  - æœŸé–“æŒ‡å®š
- ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆä½œæ¥­æ—¥ã€é–‹ç™ºè€…åã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰
- ä¸€æ‹¬æ‰¿èªæ©Ÿèƒ½ï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§è¤‡æ•°é¸æŠï¼‰
- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ20ä»¶/50ä»¶/100ä»¶ï¼‰

#### 3. å´ä¸‹ç†ç”±å…¥åŠ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚°

**ç”»é¢è¦ç´ **
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å´ä¸‹ç†ç”±ã®å…¥åŠ›                                  [ Ã— ]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å´ä¸‹ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆå¿…é ˆï¼‰:                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                      â”‚ â”‚
â”‚ â”‚                                                      â”‚ â”‚
â”‚ â”‚                                                      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:                                            â”‚
â”‚ [å·¥æ•°ãŒéå¤§] [å†…å®¹ãŒä¸æ˜ç¢º] [ã‚«ãƒ†ã‚´ãƒªèª¤ã‚Š]              â”‚
â”‚                                                          â”‚
â”‚ [å´ä¸‹] [ã‚­ãƒ£ãƒ³ã‚»ãƒ«]                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½ä»•æ§˜**
- å´ä¸‹ç†ç”±ã®å…¥åŠ›ï¼ˆå¿…é ˆã€æœ€å¤§500æ–‡å­—ï¼‰
- ã‚ˆãä½¿ã†ç†ç”±ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ©Ÿèƒ½
- å…¥åŠ›å†…å®¹ã®ä¸€æ™‚ä¿å­˜

#### 4. æ‰¿èªå±¥æ­´ç”»é¢

**ç”»é¢è¦ç´ **
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰¿èªå±¥æ­´                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æœŸé–“: [2024-01-01] ï½ [2024-01-31] [æ¤œç´¢]              â”‚
â”‚                                                          â”‚
â”‚ ä½œæ¥­æ—¥      ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ  å·¥æ•°   çŠ¶æ…‹    æ‰¿èªè€…   æ—¥æ™‚   â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2024-01-15  Project A    8.0h   ğŸŸ¢æ‰¿èª  å±±ç”°éƒ¨é•· 01-16 â”‚
â”‚ 2024-01-14  Project B    7.5h   ğŸŸ¢æ‰¿èª  å±±ç”°éƒ¨é•· 01-15 â”‚
â”‚ 2024-01-13  Project A    8.5h   ğŸ”´å´ä¸‹  å±±ç”°éƒ¨é•· 01-14 â”‚
â”‚   â”” å´ä¸‹ç†ç”±: ã‚«ãƒ†ã‚´ãƒªã®é…åˆ†ã‚’è¦‹ç›´ã—ã¦ãã ã•ã„          â”‚
â”‚ 2024-01-12  Project C    8.0h   ğŸŸ¢æ‰¿èª  å±±ç”°éƒ¨é•· 01-13 â”‚
â”‚                                                          â”‚
â”‚ çµ±è¨ˆ:                                                    â”‚
â”‚ â”œâ”€æ‰¿èªæ¸ˆã¿: 125.5h (92%)                               â”‚
â”‚ â”œâ”€å´ä¸‹: 10.5h (8%)                                     â”‚
â”‚ â””â”€æ‰¿èªå¾…ã¡: 16.0h                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½ä»•æ§˜**
- è‡ªåˆ†ã®å·¥æ•°ã®æ‰¿èªå±¥æ­´ã‚’è¡¨ç¤ºï¼ˆé–‹ç™ºè€…ï¼‰
- éƒ¨ä¸‹ã®æ‰¿èªå±¥æ­´ã‚’è¡¨ç¤ºï¼ˆä¸Šé•·ï¼‰
- ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½ï¼ˆæœŸé–“ã€çŠ¶æ…‹ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰
- å´ä¸‹ç†ç”±ã®è¡¨ç¤º
- æ‰¿èªçµ±è¨ˆã®è¡¨ç¤º
- CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½

#### 5. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆæ‹¡å¼µï¼‰

**ç”»é¢è¦ç´ **
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ â”‚ æ‰¿èªå¾…ã¡    â”‚ â”‚ æœªå…¥åŠ›      â”‚ â”‚ å¹³å‡æ‰¿èªæ™‚é–“ â”‚      â”‚
â”‚ â”‚    12ä»¶     â”‚ â”‚    5ä»¶      â”‚ â”‚   1.2æ—¥     â”‚      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                          â”‚
â”‚ æ‰¿èªå¾…ã¡ã‚¢ãƒ©ãƒ¼ãƒˆ:                                        â”‚
â”‚ âš ï¸ 3æ—¥ä»¥ä¸Šæ‰¿èªå¾…ã¡: 2ä»¶                                 â”‚
â”‚ âš ï¸ ç”°ä¸­å¤ªéƒ: 2024-01-12ã®å·¥æ•°ãŒæœªæ‰¿èª                   â”‚
â”‚                                                          â”‚
â”‚ æœªå…¥åŠ›ã‚¢ãƒ©ãƒ¼ãƒˆ:                                          â”‚
â”‚ âš ï¸ éˆ´æœ¨èŠ±å­: 2024-01-10, 2024-01-11 æœªå…¥åŠ›             â”‚
â”‚ âš ï¸ ä½è—¤æ¬¡éƒ: 2024-01-12 æœªå…¥åŠ›                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½ä»•æ§˜**
- æ‰¿èªé–¢é€£ã®KPIè¡¨ç¤ºï¼ˆæ‰¿èªå¾…ã¡ä»¶æ•°ã€æœªå…¥åŠ›ä»¶æ•°ã€å¹³å‡æ‰¿èªæ™‚é–“ï¼‰
- æœªå…¥åŠ›ä»¶æ•°ï¼šéƒ¨ä¸‹ã®å¹³æ—¥ï¼ˆæœˆã€œé‡‘ï¼‰ã§å·¥æ•°æœªå…¥åŠ›ã®æ—¥æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
- æ‰¿èªå¾…ã¡ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆ3æ—¥ä»¥ä¸ŠçµŒéï¼‰
- æœªå…¥åŠ›ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆéƒ¨ä¸‹ã”ã¨ã®æœªå…¥åŠ›æ—¥ã‚’è¡¨ç¤ºï¼‰
- ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆæ‰¿èªå¾…ã¡ä¸€è¦§ã¸ï¼‰

#### 6. ä¸Šé•·è¨­å®šç”»é¢

**ç”»é¢è¦ç´ **
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸Šé•·è¨­å®šç®¡ç†                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æ–°è¦è¨­å®š]                                              â”‚
â”‚                                                          â”‚
â”‚ æ¤œç´¢: [                    ] [æ¤œç´¢]                     â”‚
â”‚                                                          â”‚
â”‚ é–‹ç™ºè€…        ç¾åœ¨ã®ä¸Šé•·    æœ‰åŠ¹æœŸé–“        ã‚¢ã‚¯ã‚·ãƒ§ãƒ³   â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç”°ä¸­å¤ªéƒ      å±±ç”°éƒ¨é•·     2024-01-01ï½    [ç·¨é›†][å‰Šé™¤] â”‚
â”‚ éˆ´æœ¨èŠ±å­      å±±ç”°éƒ¨é•·     2024-01-01ï½    [ç·¨é›†][å‰Šé™¤] â”‚
â”‚ ä½è—¤æ¬¡éƒ      æœªè¨­å®š       -              [è¨­å®š]       â”‚
â”‚ é«˜æ©‹å››éƒ      ä½ã€…æœ¨èª²é•·   2023-04-01ï½    [ç·¨é›†][å‰Šé™¤] â”‚
â”‚                                                          â”‚
â”‚ âš ï¸ ä¸Šé•·æœªè¨­å®š: 3å                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ©Ÿèƒ½ä»•æ§˜**
- ä¸Šé•·é–¢ä¿‚ã®ä¸€è¦§è¡¨ç¤º
- ä¸Šé•·ã®è¨­å®š/å¤‰æ›´/å‰Šé™¤
- æœ‰åŠ¹æœŸé–“ã®ç®¡ç†
- ä¸Šé•·æœªè¨­å®šè€…ã®ã‚¢ãƒ©ãƒ¼ãƒˆ
- å±¥æ­´ç®¡ç†ï¼ˆéå»ã®ä¸Šé•·é–¢ä¿‚ï¼‰

### UI/UXã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

#### 1. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
- ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œï¼ˆæ‰¿èªæ“ä½œã‚’ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã‹ã‚‰å¯èƒ½ã«ï¼‰
- ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆæœ€é©åŒ–ï¼ˆä¸Šé•·ã®æ‰¿èªä½œæ¥­ç”¨ï¼‰
- ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãƒ•ãƒ«æ©Ÿèƒ½

#### 2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- é…å»¶ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
- ä»®æƒ³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆå¤§é‡ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºæ™‚ï¼‰
- æ¥½è¦³çš„UIæ›´æ–°

#### 3. é€šçŸ¥ã¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
- ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ï¼ˆæ‰¿èª/å´ä¸‹å®Œäº†æ™‚ï¼‰
- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…æŠ€è¡“

#### 1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ
```
frontend/src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ approvals/
â”‚   â”‚   â”œâ”€â”€ ApprovalList.vue        # æ‰¿èªå¾…ã¡ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«
â”‚   â”‚   â”œâ”€â”€ ApprovalActions.vue     # æ‰¿èª/å´ä¸‹ãƒœã‚¿ãƒ³
â”‚   â”‚   â”œâ”€â”€ RejectionDialog.vue     # å´ä¸‹ç†ç”±å…¥åŠ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
â”‚   â”‚   â””â”€â”€ ApprovalFilters.vue     # ãƒ•ã‚£ãƒ«ã‚¿ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ work-records/
â”‚   â”‚   â”œâ”€â”€ WorkRecordForm.vue      # å·¥æ•°å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆæ‹¡å¼µï¼‰
â”‚   â”‚   â””â”€â”€ ApprovalStatus.vue      # æ‰¿èªçŠ¶æ³è¡¨ç¤º
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ ApprovalMetrics.vue     # KPIã‚«ãƒ¼ãƒ‰ï¼ˆæ‰¿èªå¾…ã¡ã€æœªå…¥åŠ›ã€å¹³å‡æ™‚é–“ï¼‰
â”‚   â”‚   â”œâ”€â”€ PendingAlerts.vue       # æ‰¿èªå¾…ã¡ã‚¢ãƒ©ãƒ¼ãƒˆ
â”‚   â”‚   â””â”€â”€ MissingEntryAlerts.vue  # æœªå…¥åŠ›ã‚¢ãƒ©ãƒ¼ãƒˆ
â”‚   â””â”€â”€ admin/
â”‚       â””â”€â”€ SupervisorSettings.vue  # ä¸Šé•·è¨­å®šç®¡ç†
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ ApprovalsView.vue           # æ‰¿èªå¾…ã¡ä¸€è¦§ç”»é¢
â”‚   â”œâ”€â”€ ApprovalHistoryView.vue     # æ‰¿èªå±¥æ­´ç”»é¢
â”‚   â”œâ”€â”€ DashboardView.vue           # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”»é¢ï¼ˆæ‹¡å¼µï¼‰
â”‚   â””â”€â”€ AdminSupervisorsView.vue    # ä¸Šé•·è¨­å®šç”»é¢
â””â”€â”€ services/
    â”œâ”€â”€ approvalApi.ts               # æ‰¿èªé–¢é€£API
    â”œâ”€â”€ supervisorApi.ts             # ä¸Šé•·ç®¡ç†API
    â””â”€â”€ workRecordApi.ts             # å·¥æ•°è¨˜éŒ²APIï¼ˆæ‹¡å¼µï¼‰
```

#### 2. çŠ¶æ…‹ç®¡ç†ï¼ˆPinia/Vuexï¼‰
```typescript
// stores/approval.ts
interface ApprovalState {
  pendingApprovals: WorkRecord[]
  approvalHistory: ApprovalHistory[]
  statistics: ApprovalStatistics
  filters: ApprovalFilters
}

// Actions
- fetchPendingApprovals()
- approveWorkRecord(id: string)
- rejectWorkRecord(id: string, reason: string)
- bulkApprove(ids: string[])
```

## ãƒªã‚¹ã‚¯ã¨å¯¾ç­–

| ãƒªã‚¹ã‚¯ | å½±éŸ¿åº¦ | å¯¾ç­– |
|-------|--------|------|
| å¤§é‡ãƒ‡ãƒ¼ã‚¿ã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ– | é«˜ | ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–ã€ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£… |
| æ‰¿èªæ¨©é™ã®èª¤è¨­å®š | é«˜ | ç®¡ç†è€…ã®ã¿ä¸Šé•·è¨­å®šå¯èƒ½ã€å¤‰æ›´ãƒ­ã‚°è¨˜éŒ² |
| æ‰¿èªå±¥æ­´ã®æ”¹ã–ã‚“ | ä¸­ | ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ¬ãƒ™ãƒ«ã§UPDATE/DELETEç¦æ­¢ |
| åŒæ™‚æ‰¿èªã«ã‚ˆã‚‹ç«¶åˆ | ä½ | æ¥½è¦³çš„ãƒ­ãƒƒã‚¯å®Ÿè£… |